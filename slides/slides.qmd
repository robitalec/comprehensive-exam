---
title: "Comprehensive exam"
date: "2023-04-17"
author:
  - name: Alec L. Robitaille
    affiliations:
      - name: "Memorial University of Newfoundland and Labrador"
format:
  revealjs: 
    theme: [dark, custom.scss]
date-format: iso
---



## <!-- Question --> {.center} 


```{r}
#| echo: false
#| include: false
source('R/packages.R')
```

### In the context of frequency-dependent producer-scrounger dynamics, how would one's role affect access to available resources considering risks and conditions during habitat selection?

## <!-- Question, color --> {.center} 

### <span style="color: #42727c">In the context of </span><span style="color: #9d7195">frequency-dependent producer-scrounger dynamics</span><span style="color: #42727c">, how would one's </span><span style="color: #9d7195">role</span><span style="color: #42727c"> affect </span><span style="color: #AD8F89">access</span><span style="color: #42727c"> to </span><span style="color: #AD8F89">available resources</span><span style="color: #42727c"> considering </span><span style="color: #959D71">risks and conditions</span><span style="color: #42727c"> during </span><span style="color: #959D71">habitat selection</span><span style="color: #42727c">?</span>

## <!-- Flowchart --> {.center} 

:::: {.columns}

::: {.column width="50%"}
```{dot}
//| fig-width: 3.5
digraph habitat_and_producer {
  bgcolor = transparent;
  rankdir = TB
	node [fontsize = 40, shape = box, fontname = Helvetica, fontcolor = "#e1e1e1", style = filled, color = "#3f6f7a", fillcolor = "#3f6f7a", penwidth = 4]
	edge [penwidth = 5, color = "#9d9d9d"] 
	Habitat [label = "Habitat\nselection"]
	Resources []
	Conditions []
	Risks []

    Roles []
	access_avail [label = "Availability\nand\naccess", shape = ellipse]
	ps_dyn [label = "Producer-scrounger\ndynamics"]
	freq [label = "Frequency\ndependence"]
	patch_penalties [label = "Patch penalties"]
	patch_payoffs [label = "Patch payoffs"]

	ps_dyn -> Roles -> freq -> {patch_penalties patch_payoffs}
	{patch_penalties patch_payoffs} -> access_avail
	access_avail -> {Resources Conditions Risks} [dir = back]
	{patch_penalties} ->  Risks [color = "#707070", dir = back]
	patch_payoffs -> Resources [color = "#707070", dir = back]
	{patch_payoffs patch_penalties} -> Conditions [color = "#707070", dir = back]
	{Resources Risks Conditions} -> Habitat [dir = back]
}
```
:::

::: {.column width="50%"}
Objectives:

1. Access depending on role
1. Risks and conditions influence on role
1. Integrating role in habitat selection 
:::
::::


## <!-- Producer-scrounger roles --> {.center} 

:::: {.columns}

::: {.column width="50%"}
```{dot}
//| fig-width: 3.5
digraph habitat_and_producer {
  bgcolor = transparent;
  rankdir = TB
	node [fontsize = 40, shape = box, fontname = Helvetica, fontcolor = "#9d9d9d", style = filled, color = "#325861", fillcolor = "#325861", penwidth = 6]
	edge [penwidth = 5, color = "#9d9d9d"] 
	Habitat [label = "Habitat\nselection"]
	Resources
	Conditions
	Risks

    Roles [color = "#9d7195", fontcolor = "#e1e1e1", fillcolor = "#9d7195"]
	ps_dyn [label = "Producer-scrounger\ndynamics", color = "#9d7195", fillcolor = "#9d7195", fontcolor = "#e1e1e1"]
	freq [label = "Frequency\ndependence"]
	patch_penalties [label = "Patch penalties"]
	patch_payoffs [label = "Patch payoffs"]
	access_avail [label = "Availability\nand\naccess", shape = ellipse]

	ps_dyn -> Roles -> freq -> {patch_penalties patch_payoffs}
	{patch_penalties patch_payoffs} -> access_avail
	access_avail -> {Resources Conditions Risks} [dir = back]
	{patch_penalties} ->  Risks [color = "#707070", dir = back]
	patch_payoffs -> Resources [color = "#707070", dir = back]
	{patch_payoffs patch_penalties} -> Conditions [color = "#707070", dir = back]
	{Resources Risks Conditions} -> Habitat [dir = back]
}
```
:::


::: {.column width="50%"}
<br>
<br>

Producers

Scroungers

(Opportunists)

:::

::::



## <!-- Producer-scrounger video --> 


{{< video https://www.youtube.com/embed/B1h1mDgSjOc width="100%" height="85%"  >}}


## <!-- Frequency, payoffs, penalties --> {.center} 

:::: {.columns}

::: {.column width="50%"}
```{dot}
//| fig-width: 3.5
digraph habitat_and_producer {
  bgcolor = transparent;
  rankdir = TB
	node [fontsize = 40, shape = box, fontname = Helvetica, fontcolor = "#9d9d9d", style = filled, color = "#325861", fillcolor = "#325861", penwidth = 6]
	edge [penwidth = 5, color = "#9d9d9d"] 
	Habitat [label = "Habitat\nselection"]
	Resources
	Conditions
	Risks

    Roles 
	ps_dyn [label = "Producer-scrounger\ndynamics"]
	freq [label = "Frequency\ndependence", color = "#9d7195", fillcolor = "#9d7195", fontcolor = "#e1e1e1"]
	patch_penalties [label = "Patch penalties", color = "#9d7195", fillcolor = "#9d7195", fontcolor = "#e1e1e1"]
	patch_payoffs [label = "Patch payoffs", color = "#9d7195", fillcolor = "#9d7195", fontcolor = "#e1e1e1"]
	access_avail [label = "Availability\nand\naccess", shape = ellipse]

	ps_dyn -> Roles -> freq -> {patch_penalties patch_payoffs}
	{patch_penalties patch_payoffs} -> access_avail
	access_avail -> {Resources Conditions Risks} [dir = back]
	{patch_penalties} ->  Risks [color = "#707070", dir = back]
	patch_payoffs -> Resources [color = "#707070", dir = back]
	{patch_payoffs patch_penalties} -> Conditions [color = "#707070", dir = back]
	{Resources Risks Conditions} -> Habitat [dir = back]
}
```
:::


::: {.column width="50%"}
<br>

<br>

Payoffs

Penalties

Frequency dependence
:::

::::



<!-- 
examples of frequency dependence, payoffs, penalties

--> 

## <!-- Access depending on role --> {.center} 

:::: {.columns}

::: {.column width="50%"}
```{dot}
//| fig-width: 3.5
digraph habitat_and_producer {
  bgcolor = transparent;
  rankdir = TB
	node [fontsize = 40, shape = box, fontname = Helvetica, fontcolor = "#9d9d9d", style = filled, color = "#325861", fillcolor = "#325861", penwidth = 6]
	edge [penwidth = 5, color = "#9d9d9d"] 
	Habitat [label = "Habitat\nselection"]
	Resources
	Conditions
	Risks

    Roles [color = "#9d7195", fillcolor = "#9d7195", fontcolor = "#e1e1e1"]
	ps_dyn [label = "Producer-scrounger\ndynamics"]
	freq [label = "Frequency\ndependence"]
	patch_penalties [label = "Patch penalties"]
	patch_payoffs [label = "Patch payoffs"]
	access_avail [label = "Availability\nand\naccess", shape = ellipse, fillcolor = "#AD8F89", color = "#AD8F89", fontcolor = "#e1e1e1"]

	ps_dyn -> Roles -> freq -> {patch_penalties patch_payoffs}
	{patch_penalties patch_payoffs} -> access_avail
	access_avail -> {Resources Conditions Risks} [dir = back]
	{patch_penalties} ->  Risks [color = "#707070", dir = back]
	patch_payoffs -> Resources [color = "#707070", dir = back]
	{patch_payoffs patch_penalties} -> Conditions [color = "#707070", dir = back]
	{Resources Risks Conditions} -> Habitat [dir = back]
}
```
:::


::: {.column width="50%"}
<br>

<br>

Objective 1: how does role in producer-scrounger dynamics affect access to available resources?
:::

::::

## <!-- Access - producer --> {.center} 

:::: {.columns}

::: {.column width="50%"}
```{dot}
//| fig-width: 3.5
digraph habitat_and_producer {
  bgcolor = transparent;
  rankdir = TB
	node [fontsize = 40, shape = box, fontname = Helvetica, fontcolor = "#9d9d9d", style = filled, color = "#325861", fillcolor = "#325861", penwidth = 6]
	edge [penwidth = 5, color = "#9d9d9d"] 
	Habitat [label = "Habitat\nselection"]
	Resources
	Conditions
	Risks

    Roles [color = "#9d7195", fillcolor = "#9d7195", fontcolor = "#e1e1e1"]
	ps_dyn [label = "Producer-scrounger\ndynamics"]
	freq [label = "Frequency\ndependence"]
	patch_penalties [label = "Patch penalties"]
	patch_payoffs [label = "Patch payoffs"]
	access_avail [label = "Availability\nand\naccess", shape = ellipse, fillcolor = "#AD8F89", color = "#AD8F89", fontcolor = "#e1e1e1"]

	ps_dyn -> Roles -> freq -> {patch_penalties patch_payoffs}
	{patch_penalties patch_payoffs} -> access_avail
	access_avail -> {Resources Conditions Risks} [dir = back]
	{patch_penalties} ->  Risks [color = "#707070", dir = back]
	patch_payoffs -> Resources [color = "#707070", dir = back]
	{patch_payoffs patch_penalties} -> Conditions [color = "#707070", dir = back]
	{Resources Risks Conditions} -> Habitat [dir = back]
}
```
:::


::: {.column width="50%"}
```{r}
#| echo: false
#| fig-width: 7
#| fig-height: 6
# Producer ----------------------------------------------------------------
DT_ed <- CJ(id = 'A', obs = seq.int(3), rdm = seq.int(5))

DT_pt <- CJ(id = 'A', obs = seq.int(3))
DT_pt[, c('x', 'y') := .(c(-1, 0, 1), c(1, -1, 0))]

DT_pt_rdm <- DT_ed[DT_pt, on = .(id, obs)]
DT_pt_rdm[, c('x_rdm', 'y_rdm') := .(x + rnorm(.N, sd = 0.5), y + rnorm(.N, sd = 0.5))]


ggplot(DT_pt_rdm) +
	geom_point(aes(x, y), size = 4) +
	geom_segment(aes(x = x, y = y, xend = x_rdm, yend = y_rdm),
				 size = 1,
				 arrow = arrow(length = unit(0.2, 'inches'))) +
	geom_line(aes(x, y), linewidth = 2)  +
	theme_void() + 
	coord_fixed()
```
:::

::::


## <!-- Access - scrounger --> {.center} 

:::: {.columns}

::: {.column width="50%"}
```{dot}
//| fig-width: 3.5
digraph habitat_and_producer {
  bgcolor = transparent;
  rankdir = TB
	node [fontsize = 40, shape = box, fontname = Helvetica, fontcolor = "#9d9d9d", style = filled, color = "#325861", fillcolor = "#325861", penwidth = 6]
	edge [penwidth = 5, color = "#9d9d9d"] 
	Habitat [label = "Habitat\nselection"]
	Resources
	Conditions
	Risks

    Roles [color = "#9d7195", fillcolor = "#9d7195", fontcolor = "#e1e1e1"]
	ps_dyn [label = "Producer-scrounger\ndynamics"]
	freq [label = "Frequency\ndependence"]
	patch_penalties [label = "Patch penalties"]
	patch_payoffs [label = "Patch payoffs"]
	access_avail [label = "Availability\nand\naccess", shape = ellipse, fillcolor = "#AD8F89", color = "#AD8F89", fontcolor = "#e1e1e1"]

	ps_dyn -> Roles -> freq -> {patch_penalties patch_payoffs}
	{patch_penalties patch_payoffs} -> access_avail
	access_avail -> {Resources Conditions Risks} [dir = back]
	{patch_penalties} ->  Risks [color = "#707070", dir = back]
	patch_payoffs -> Resources [color = "#707070", dir = back]
	{patch_payoffs patch_penalties} -> Conditions [color = "#707070", dir = back]
	{Resources Risks Conditions} -> Habitat [dir = back]
}
```
:::


::: {.column width="50%"}
```{r}
#| echo: false
#| fig-width: 7
#| fig-height: 6
# Scrounger -------------------------------------------------------------
DT_id <- CJ(id = c('A'), pr_id = c('C', 'D', 'E'), obs = seq.int(1))
DT_id[, c('x', 'y') := .(c(-1, 0.2, 1), c(1, -0.5, 0.4))]


DT_sc <- CJ(id = c('A'), obs = seq.int(1))
DT_sc[, c('x', 'y') := .(0, 0)]

ggplot(DT_sc[DT_id, on = 'id']) +
	geom_point(aes(x, y), size = 7) +
	geom_point(aes(i.x, i.y, color = pr_id), size = 5) +
	geom_segment(aes(x = x, y = y, xend = i.x, yend = i.y),
				 size = 0.9, 
				 arrow = arrow(length = unit(0.2, 'inches'))) +
	guides(color = 'none') + 
	theme_void()
```
:::

::::


<!-- Lead into habitats are more complex than distributed patches of forage --> 
<!-- Matt et al definition of habitat --> 


## <!-- Habitat selection --> {.center} 


:::: {.columns}

::: {.column width="50%"}
```{dot}
//| fig-width: 3.5
digraph habitat_and_producer {
  bgcolor = transparent;
  rankdir = TB
	node [fontsize = 40, shape = box, fontname = Helvetica, fontcolor = "#9d9d9d", style = filled, color = "#325861", fillcolor = "#325861", penwidth = 6]
	edge [penwidth = 5, color = "#9d9d9d"] 
	Habitat [label = "Habitat\nselection"]
	Resources [color = "#959D71", fillcolor = "#959D71", fontcolor = "#e1e1e1"]
	Conditions [color = "#959D71", fillcolor = "#959D71", fontcolor = "#e1e1e1"]
	Risks [color = "#959D71", fillcolor = "#959D71", fontcolor = "#e1e1e1"]

    Roles []
	access_avail [label = "Availability\nand\naccess", shape = ellipse]
	ps_dyn [label = "Producer-scrounger\ndynamics"]
	freq [label = "Frequency\ndependence"]
	patch_penalties [label = "Patch penalties"]
	patch_payoffs [label = "Patch payoffs"]

	ps_dyn -> Roles -> freq -> {patch_penalties patch_payoffs}
	{patch_penalties patch_payoffs} -> access_avail
	access_avail -> {Resources Conditions Risks} [dir = back]
	{patch_penalties} ->  Risks [color = "#707070", dir = back]
	patch_payoffs -> Resources [color = "#707070", dir = back]
	{patch_payoffs patch_penalties} -> Conditions [color = "#707070", dir = back]
	{Resources Risks Conditions} -> Habitat [dir = back]
}
```
:::


::: {.column width="50%"}

<br> 

<br> 

Habitats = 

Resources + 

Risks +  

Conditions
:::

::::

## <!-- Resources --> {.center} 

:::: {.columns}
::: {.column width="50%"}
```{dot}
//| fig-width: 3.5
digraph habitat_and_producer {
  bgcolor = transparent;
  rankdir = TB
	node [fontsize = 40, shape = box, fontname = Helvetica, fontcolor = "#9d9d9d", style = filled, color = "#325861", fillcolor = "#325861", penwidth = 6]
	edge [penwidth = 5, color = "#9d9d9d"] 
	Habitat [label = "Habitat\nselection"]
	Resources [color = "#959D71", fillcolor = "#959D71", fontcolor = "#e1e1e1"]
	Conditions []
	Risks []

    Roles []
	access_avail [label = "Availability\nand\naccess", shape = ellipse]
	ps_dyn [label = "Producer-scrounger\ndynamics"]
	freq [label = "Frequency\ndependence"]
	patch_penalties [label = "Patch penalties"]
	patch_payoffs [label = "Patch payoffs"]

	ps_dyn -> Roles -> freq -> {patch_penalties patch_payoffs}
	{patch_penalties patch_payoffs} -> access_avail
	access_avail -> {Resources Conditions Risks} [dir = back]
	{patch_penalties} ->  Risks [color = "#707070", dir = back]
	patch_payoffs -> Resources [color = "#707070", dir = back]
	{patch_payoffs patch_penalties} -> Conditions [color = "#707070", dir = back]
	{Resources Risks Conditions} -> Habitat [dir = back]
}
```
:::


::: {.column width="50%"}
Resources

```{r}
library(ggplot2)

ggplot(data.frame(x = c(0, 3)), aes(x)) +
  stat_function(fun = exp, geom = 'line', linewidth = 3) + 
  theme_minimal(base_size = 30) + 
  labs(x = 'Resource', y = 'Expected effect on fitness')
```

E.g. forage patch quality, density, or resting spaces

:::

::::



## <!--Risks--> {.center} 


:::: {.columns}
::: {.column width="50%"}
```{dot}
//| fig-width: 3.5
digraph habitat_and_producer {
  bgcolor = transparent;
  rankdir = TB
	node [fontsize = 40, shape = box, fontname = Helvetica, fontcolor = "#9d9d9d", style = filled, color = "#325861", fillcolor = "#325861", penwidth = 6]
	edge [penwidth = 5, color = "#9d9d9d"] 
	Habitat [label = "Habitat\nselection"]
	Resources []
	Conditions []
	Risks [color = "#959D71", fillcolor = "#959D71", fontcolor = "#e1e1e1"]

    Roles []
	access_avail [label = "Availability\nand\naccess", shape = ellipse]
	ps_dyn [label = "Producer-scrounger\ndynamics"]
	freq [label = "Frequency\ndependence"]
	patch_penalties [label = "Patch penalties"]
	patch_payoffs [label = "Patch payoffs"]

	ps_dyn -> Roles -> freq -> {patch_penalties patch_payoffs}
	{patch_penalties patch_payoffs} -> access_avail
	access_avail -> {Resources Conditions Risks} [dir = back]
	{patch_penalties} ->  Risks [color = "#707070", dir = back]
	patch_payoffs -> Resources [color = "#707070", dir = back]
	{patch_payoffs patch_penalties} -> Conditions [color = "#707070", dir = back]
	{Resources Risks Conditions} -> Habitat [dir = back]
}
```
:::


::: {.column width="50%"}
Risks

```{r}
library(ggplot2)

ggplot(data.frame(x = c(0, 3)), aes(x)) +
  stat_function(fun = function(x) 1/exp(x), geom = 'line', linewidth = 3) + 
  theme_minimal(base_size = 30) + 
  labs(x = 'Risks', y = 'Expected effect on fitness')
```

E.g. predation, anthropogenic disturbance or harvest

:::

::::


## <!--Conditions--> {.center} 

:::: {.columns}
::: {.column width="50%"}
```{dot}
//| fig-width: 3.5
digraph habitat_and_producer {
  bgcolor = transparent;
  rankdir = TB
	node [fontsize = 40, shape = box, fontname = Helvetica, fontcolor = "#9d9d9d", style = filled, color = "#325861", fillcolor = "#325861", penwidth = 6]
	edge [penwidth = 5, color = "#9d9d9d"] 
	Habitat [label = "Habitat\nselection"]
	Resources []
	Conditions [color = "#959D71", fillcolor = "#959D71", fontcolor = "#e1e1e1"]
	Risks []

    Roles []
	access_avail [label = "Availability\nand\naccess", shape = ellipse]
	ps_dyn [label = "Producer-scrounger\ndynamics"]
	freq [label = "Frequency\ndependence"]
	patch_penalties [label = "Patch penalties"]
	patch_payoffs [label = "Patch payoffs"]

	ps_dyn -> Roles -> freq -> {patch_penalties patch_payoffs}
	{patch_penalties patch_payoffs} -> access_avail
	access_avail -> {Resources Conditions Risks} [dir = back]
	{patch_penalties} ->  Risks [color = "#707070", dir = back]
	patch_payoffs -> Resources [color = "#707070", dir = back]
	{patch_payoffs patch_penalties} -> Conditions [color = "#707070", dir = back]
	{Resources Risks Conditions} -> Habitat [dir = back]
}
```
:::


::: {.column width="50%"}
Conditions

```{r}
library(ggplot2)

ggplot(data.frame(x = c(-3, 3)), aes(x)) +
  stat_function(fun = function(x) dnorm(scale(x)), geom = 'line', linewidth = 3) + 
  theme_minimal(base_size = 30) + 
  labs(x = 'Conditions', y = 'Expected effect on fitness')
```

E.g. temperature, humidity, salinity

:::

::::


<!-- Objective 2 -->


## <!-- Table 1 - Resources -->{.small}

```{r}
tar_read(rrc_results)[Type == 'Resources', .(Type, Variable, 'Producer-scrounger model' = str_trunc(`Producer scrounger model`, width = 40, ellipsis = '...)'), `Empirical test`)] |>
	gt(rowname_col = 'Variable',
     groupname_col = 'Type') |>
	tab_options(row_group.as_column = TRUE) |>
	tab_style(
		style = list(
		cell_fill(color = "#134f5c"),
		cell_text(color = "#e1e1e1", weight = 'normal')
		),
		locations = cells_stub()
	) |>
	tab_style(
		style = list(
		cell_fill(color = "#134f5c"),
		cell_text(color = "#e1e1e1")
		),
		locations = cells_row_groups()
	)
```

## <!-- Table 1 - Risks -->{.small}

```{r}
tar_read(rrc_results)[Type == 'Risks' & Variable != 'Drought', .(Type, Variable, 'Producer-scrounger model' = str_trunc(`Producer scrounger model`, width = 40, ellipsis = '...)'), `Empirical test`)] |>
	gt(rowname_col = 'Variable',
     groupname_col = 'Type') |>
	tab_options(row_group.as_column = TRUE) |>
	tab_style(
		style = list(
		cell_fill(color = "#134f5c"),
		cell_text(color = "#e1e1e1", weight = 'normal')
		),
		locations = cells_stub()
	) |>
	tab_style(
		style = list(
		cell_fill(color = "#134f5c"),
		cell_text(color = "#e1e1e1")
		),
		locations = cells_row_groups()
	)
```

## <!-- Table 1 - Conditions -->{.small}

```{r}
tar_read(rrc_results)[Type == 'Conditions', .(Type, Variable, 'Producer-scrounger model' = str_trunc(`Producer scrounger model`, width = 40, ellipsis = '...)'), `Empirical test`)] |>
	gt(rowname_col = 'Variable',
     groupname_col = 'Type') |>
	tab_options(row_group.as_column = TRUE) |>
	tab_style(
		style = list(
		cell_fill(color = "#134f5c"),
		cell_text(color = "#e1e1e1", weight = 'normal')
		),
		locations = cells_stub()
	) |>
	tab_style(
		style = list(
		cell_fill(color = "#134f5c"),
		cell_text(color = "#e1e1e1")
		),
		locations = cells_row_groups()
	)
```



## Software

- quarto
- Revealjs
- data.table
- ggplot2
- targets
- NLMR
